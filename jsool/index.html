<html>
<head>
	<title>Tester</title>
	
	<link rel="stylesheet" type="text/css" href="css/widget.css"></link>
	
	<script type="text/javascript" src="js/core/Main.js"></script>
	<script type="text/javascript" src="js/core/Browser.js"></script>
	<script type="text/javascript" src="js/core/Object.js"></script>
	<script type="text/javascript" src="js/core/Number.js"></script>
	<script type="text/javascript" src="js/core/Array.js"></script>
	<script type="text/javascript" src="js/core/String.js"></script>
	<script type="text/javascript" src="js/core/Exception.js"></script>
	
	<script type="text/javascript" src="js/util/Collection.js"></script>
	<script type="text/javascript" src="js/util/List.js"></script>
	<script type="text/javascript" src="js/util/ArrayList.js"></script>
	<script type="text/javascript" src="js/util/LinkedList.js"></script>
	<script type="text/javascript" src="js/util/HashSet.js"></script>
	<script type="text/javascript" src="js/util/Map.js"></script>
	<script type="text/javascript" src="js/util/HashMap.js"></script>
	<script type="text/javascript" src="js/util/ReferenceMap.js"></script>
	<script type="text/javascript" src="js/util/StringBuilder.js"></script>
	<script type="text/javascript" src="js/util/Locale.js"></script>
	<script type="text/javascript" src="js/util/Serializable.js"></script>
	<script type="text/javascript" src="js/util/Observable.js"></script>
	<script type="text/javascript" src="js/util/DateFormat.js"></script>
	
	<script type="text/javascript" src="js/html/Element.js"></script>
	<script type="text/javascript" src="js/html/DomQuery.js"></script>
	
	<script type="text/javascript" src="js/canvas/Canvas.js"></script>
	<script type="text/javascript" src="js/canvas/CanvasRenderingContext.js"></script>

	<script type="text/javascript" src="js/net/HttpRequest.js"></script>
	<script type="text/javascript" src="js/net/HttpRequestDispatcher.js"></script>
	
	<script type="text/javascript" src="js/data/Field.js"></script>
	<script type="text/javascript" src="js/data/Record.js"></script>
	<script type="text/javascript" src="js/data/Type.js"></script>
	
	<script type="text/javascript" src="js/widget/Component.js"></script>
	<script type="text/javascript" src="js/widget/Button.js"></script>
	
	<script type="text/javascript">
		jsool.onReady(function(){
			var arr = 
			[{x:1,y:5.9},
			{x:2,y:8.8},
			{x:4,y:12.0},
			{x:7,y:19.8},
			{x:9,y:21.5}];

			var sumX = arr.sum(function(p){
				return p.x;
			});
			var sumY = arr.sum(function(p){
				return p.y;
			});
			var sumX2 = arr.sum(function(p){
				return p.x * p.x;
			});
			var sumXY = arr.sum(function(p){
				return p.x * p.y;
			});

			var El = js.html.Element;

			El.get('sumx').setText(sumX);
			El.get('sumy').setText(sumY);
			El.get('sumx2').setText(sumX2);
			El.get('sumxy').setText(sumXY);
		});		
			var start = jsool.time();
			var hexaNumbers = [];
			memory = {};

			for(var i = 0; i < 16;i++){
				hexaNumbers.push(i.toString(16).toUpperCase());
			}

			var count = 0;
			for(var a = 0; a < 16; a++)for(var b = 0; b < 16; b++)
			for(var c = 0; c < 16; c++)for(var d = 0; d < 16; d++)
				memory[hexaNumbers[a]+hexaNumbers[b]+hexaNumbers[c]+hexaNumbers[d]] = {
					number: count++,
					data: null,
					program: null
				};
			
			['AX','BX','DX','CX'].forEach(function(value){
				memory[value] = null;
			});
			
			console.info(jsool.time()-start);
		});

		function MOV_MEM_TO_MEM(to ,from){
			memory[to].data = memory[from].data;
		}
		function MOV_REG_TO_MEM(to ,from){
			memory[to].data = memory[from];
		}
		function MOV_VAL_TO_MEM(to ,from){
			memory[to].data = from;
		}
		function MOV_MEM_TO_REG(to ,from){
			memory[to] = memory[from].data;
		}
		function MOV_REG_TO_REG(to ,from){
			memory[to] = memory[from];
		}
		function MOV_VAL_TO_REG(to ,from){
			memory[to] = from;
		}

		function compile(code){
			var lines = code.split('\n');
		}

		function isValue(expression){
			return expression.length == 4 && expression.match(/^[0-9ABCEDF]{4}$/) != null;
		}
		function isMemory(expression){
			return expression.length == 6 && expression.substring(0,1) == '[' && expression.substring(5,6) == ']';
		}
		function isRegister(expression){
			return expression.length == 2 && (expression in ['AX','BX','DX','CX']);
		}
		
		var compilers = {
			MOV: function(expression){
				expression = expression.split(' ');
				if(isMemory(expression[1]){
					if(isMemory(expression[2])){
						return {
							INSTRUCTION: MOV_MEM_TO_MEM,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}else if(isValue(expression[2])){
						return {
							INSTRUCTION: MOV_VAL_TO_MEM,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}else if(isRegister(expression[2])){
						return {
							INSTRUCTION: MOV_REG_TO_MEM,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}
				}else if(isRegister(expression[1])){
					if(isMemory(expression[2])){
						return {
							INSTRUCTION: MOV_MEM_TO_REG,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}else if(isValue(expression[2])){
						return {
							INSTRUCTION: MOV_VAL_TO_REG,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}else if(isRegister(expression[2])){
						return {
							INSTRUCTION: MOV_REG_TO_REG,
							ARGUMENT1: expression[1],
							ARGUMENT2: expression[2] 
						};
					}
				}
			}
		};
	</script>

</head>
<body>
	<table>
		<tr>
			<td>Soma de X:</td>
			<td id="sumx">&#160;</td>
		</tr>
		<tr>
			<td>Soma de Y:</td>
			<td id="sumy">&#160;</td>
		</tr>
		<tr>
			<td>Soma de X2:</td>
			<td id="sumx2">&#160;</td>
		</tr>
		<tr>
			<td>Soma de XY:</td>
			<td id="sumxy">&#160;</td>
		</tr>
	</table>
</body>
</html>